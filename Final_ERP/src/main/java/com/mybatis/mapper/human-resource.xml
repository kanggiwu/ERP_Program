<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd"> 
<mapper namespace="com.mybatis.mapper.HumanResourceMapper">

	<!-- 사원 리스트 출력 -->
	<select id="getEmpList" resultType="map">
		SELECT e.emp_no, e.emp_name, d.dept_name, r.rank_name, e.emp_status
 		  FROM emp e, dept d, rank r
		 WHERE e.dept_no = d.dept_no AND e.rank_no = r.rank_no
		 ORDER BY emp_no ASC
	</select>
	
	<!-- 사원리스트를 부서명, 직위명, 사원이름으로 조건검색하여 프로시저 출력 -->
	<select id="getEmpListProc" statementType="CALLABLE" parameterType="map"  resultType="map">
		{call PROC_EMP_LIST(        
          #{pdname , mode=IN,  jdbcType=VARCHAR},
          #{prname, mode=IN,  jdbcType=VARCHAR},
          #{pename, mode=IN,  jdbcType=VARCHAR},
          #{e_cursor, mode=OUT,  jdbcType=CURSOR}
       	)}
	</select>     
	
	<!-- 사원 조건 검색 넣을것인가? -->
	
	<!-- 사원 정보 등록 -->
	<insert id="insertEmpInfo" parameterType="map">
		INSERT INTO emp (emp_no, emp_name, emp_pw, emp_status, dept_no, rank_no, emp_job, emp_hiredate, emp_retiredate, emp_email, emp_tel, emp_auth, emp_picture_path)
            VALUES(#{시퀀스 추가 필요}, #{emp_name}, #{emp_pw}, #{emp_status}, #{dept_no}, #{rank_no}, #{emp_job}, #{emp_hiredate}, #{emp_retiredate}, #{emp_email}, #{emp_tel}, #{emp_auth}. #{emp_picture_path})
	</insert>

	<!-- 자격증 소유자 등록 -->
	<insert id="insertLIcenceInfo" parameterType="map">
		INSERT INTO licence_emp (emp_no, licence_no) VALUES(#{emp_no}, #{licence_no})
	</insert>

	<!-- 사원 정보 수정 -->
	<update id="updateEmpInfo" parameterType="map">
		UPDATE emp
		SET
    		emp_name = #{emp_name}
    		,emp_status = #{emp_status}
    		,dept_no = #{dept_no}
    		,rank_no = #{rank_no}
    		,emp_job = #{emp_job}
    		,emp_retiredate = #{emp_retiredate}
    		,emp_email = #{emp_email}
    		,emp_tel = #{emp_tel}
    		,emp_auth = #{emp_auth}
    		,emp_picture_path = #{emp_picture_path}
		WHERE emp_no =#{emp_no}
	</update>

</mapper>